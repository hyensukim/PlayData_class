# 5. μ¤ν”„λ§ λ””μ¤μ»¤λ²„λ¦¬ μ λ μΉ΄ μ„λ²„

μ¤ν”„λ§ ν΄λΌμ°λ“μ—μ„ μ κ³µν•λ” Eurekaλ” λ§μ΄ν¬λ΅μ„λΉ„μ¤ μ•„ν‚¤ν…μ²μ—μ„ μ„λΉ„μ¤μ λ“±λ΅, λ°κ²¬, λ° κ΄€λ¦¬λ¥Ό μ„ν• μ„λΉ„μ¤ [λ””μ¤μ»¤λ²„λ¦¬ μ„λ²„](https://github.com/hyensukim/PlayData_class/blob/main/class/%EC%96%B8%EC%96%B4%20%EC%84%A4%EB%AA%85/%EB%94%94%EC%8A%A4%EC%BB%A4%EB%B2%84%EB%A6%AC.md "μ„¤λ…")μ΄λ‹¤. μ΄λ¥Ό ν†µν•΄ λ§μ΄ν¬λ΅μ„λΉ„μ¤ κ°„μ ν†µμ‹ μ΄ ν¨μ¨μ μΌλ΅ μ΄λ¤„μ§ μ μλ‹¤.

### μ°μ„  μ„¤λ…ν•κΈ°μ— μ•μ„, Spring-cloud Eurekaλ€ λ¬΄μ—‡μΌκΉ?

μ¤ν”„λ§ ν΄λΌμ°λ“μ—μ„ μ κ³µν• APIλ¥Ό μ°Έκ³ ν•μ—¬ κ° κΈ°μ—…λ§λ‹¤ κµ¬ν„ν• μ½”λ“λ΅μ¨, Open sourceμ μ΄μ μ„ ν™μ©ν•κΈ° μ„ν•΄ Spring Cloudμ— κΈ°λ¶€ν• κµ¬ν„ μ½”λ“μ΄λ‹¤.

κ·Έ μ¤‘ ν•λ‚κ°€ Spring-cloud Eurekaμ΄λ‹¤.

Eurekaλ” 2κ°€μ§€λ΅ λ¶„λ¥λλ”λ°, Eureka Serverμ™€ Eureka Discovery Clientλ΅ κµ¬λ¶„λλ‹¤.

- Eureka Server : λ””μ¤μ»¤λ²„λ¦¬ μ„λ²„λ΅μ„, λ΅λ“ λ°Έλ°μ‹±κ³Ό ν—¬μ¤ μ²΄ν¬ κΈ°λ¥μ„ ν•λ‹¤.
- Eureka Discovery Client : μ λ μΉ΄ μ„λ²„λ΅ λ¶€ν„° κ΄€λ¦¬λ  λ§μ΄ν¬λ΅μ„λΉ„μ¤λ“¤μ„ μλ―Έν•λ‹¤.

### λ””μ¤μ»¤λ²„λ¦¬ μ„λ²„κ°€ ν•„μ”ν• μ΄μ ?

![img]()

κ²μ΄νΈμ›¨μ΄ μ„λ²„λ΅λ§ μ‚¬μ©ν•  κ²½μ°, λ΅λ“ λ°Έλ°μ‹±μ΄λ‚ ν—¬μ¤ μ²΄ν¬κΉμ§€ ν•λ”λ° μ–΄λ ¤μ›€μ΄ μμ–΄, μ΄λ¥Ό ν• λ‹Ήν• λ””μ¤μ»¤λ²„λ¦¬ μ„λ²„λ΅ λ΅λ“ λ°Έλ°μ‹± λ° ν—¬μ¤ μ²΄ν¬ κΈ°λ¥μ„ μν–‰ν•λ„λ΅ ν•λ‹¤.

## π‡ Spring cloud Eureka

### μ£Όμ” νΉμ§• :

- μ„λΉ„μ¤ λ“±λ΅(Service Registration) : λ§μ΄ν¬λ΅μ„λΉ„μ¤ μ‹μ‘ μ‹ Eureka μ„λ²„μ— μμ‹ μ μ„μΉ μ •λ³΄λ¥Ό λ“±λ΅ν•λ‹¤. μ΄λ¥Ό ν†µν•΄ λ‹¤λ¥Έ μ„λΉ„μ¤λ‚ ν΄λΌμ΄μ–ΈνΈκ°€ ν•΄λ‹Ή μ„λΉ„μ¤λ¥Ό μ°Ύμ„ μ μλ‹¤.
- μ„λΉ„μ¤ κ°μ§€(Service Discovery) : Eureka ν΄λΌμ΄μ–ΈνΈ λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•μ—¬, μ„λΉ„μ¤λ¥Ό μ°Ύκ³  ν•΄λ‹Ή μ„λΉ„μ¤μ λ©”νƒ€λ°μ΄ν„°λ¥Ό κ°€μ Έμ¬ μ μλ‹¤. μ΄λ¥Ό ν†µν•΄ λ™μ μΌλ΅ μ„λΉ„μ¤μ μ„μΉ νμ•…μ΄ κ°€λ¥ν•λ‹¤.
- μ„λΉ„μ¤ μƒνƒ κ°μ‹(Health Monitoring) : Eurekaλ” μ£ΌκΈ°μ μΌλ΅ λ“±λ΅λ μ„λΉ„μ¤μ μƒνƒλ¥Ό ν™•μΈν•λ‹¤. μ΄λ¥Ό ν†µν•΄ μ¥μ• κ°€ λ°μƒν• μ„λΉ„μ¤λ¥Ό κ°μ§€ν•κ³  λ‹¤λ¥Έ μ„λΉ„μ¤λ΅ μ”μ²­μ„ λΌμ°ν…ν•  μ μλ‹¤.
- λ™μ  μ„λΉ„μ¤ λ³€κ²½(Dynamic Service Changes) : μƒλ΅μ΄ μ„λΉ„μ¤ μΈμ¤ν„΄μ¤κ°€ μ¶”κ°€λκ±°λ‚ κΈ°μ΅΄μ μΈμ¤ν„΄μ¤κ°€ μ κ±°λμ–΄λ„ Eurekaλ” μ΄λ¥Ό κ°μ§€ν•κ³  μ„λΉ„μ¤ λ©λ΅μ„ μ—…λ°μ΄νΈν•λ‹¤.
- ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“ λ΅λ“ λ°Έλ°μ‹±(Client-Side Load Balancing) : μ λ μΉ΄ ν΄λΌμ΄μ–ΈνΈ λΌμ΄λΈλ¬λ¦¬λ” μ—¬λ¬ μΈμ¤ν„΄μ¤ μ¤‘ ν•λ‚λ¥Ό μ„ νƒν•μ—¬ μ„λΉ„μ¤λ΅ μ”μ²­μ„ λ³΄λ‚΄λ”λ°, μ΄λ¥Ό ν†µν•΄ λ¶€ν•λ¥Ό λ¶„μ‚°ν•λ‹¤.


### μ‘λ™ μ›λ¦¬ :

1. Eureka μ„λ²„ κµ¬λ™ : λ§μ΄ν¬λ΅μ„λΉ„μ¤μ—μ„ μ‚¬μ©ν•  Eureka μ„λ²„λ¥Ό μ‹¤ν–‰. μ΄λ” μ„λΉ„μ¤ λ””μ¤μ»¤λ²„λ¦¬μ μ¤‘μ‹¬ μ—­ν• μ„ ν•λ‹¤.
2. μ„λΉ„μ¤ λ“±λ΅ : λ§μ΄ν¬λ΅μ„λΉ„μ¤κ°€ μ‹μ‘λ  λ•, ν•΄λ‹Ή μ„λΉ„μ¤λ” Eureka μ„λ²„μ— μμ‹ μ μ •λ³΄λ¥Ό λ“±λ΅ν•λ‹¤. μ΄ μ •λ³΄μ—λ” μ„λΉ„μ¤μ μ΄λ¦„, IP μ£Όμ†, ν¬νΈ λ²νΈ λ“±μ μ •λ³΄κ°€ ν¬ν•¨λλ‹¤.
3. μ„λΉ„μ¤ κ°μ§€ : λ‹¤λ¥Έ λ§μ΄ν¬λ΅μ„λΉ„μ¤λ‚ ν΄λΌμ΄μ–ΈνΈκ°€ νΉμ • μ„λΉ„μ¤λ¥Ό νΈμ¶ν•κΈ° μ„ν•΄μ„λ” Eureka ν΄λΌμ΄μ–ΈνΈ λΌμ΄λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•μ—¬ Eureka μ„λ²„μ—μ„ ν•΄λ‹Ή μ„λΉ„μ¤μ μΈμ¤ν„΄μ¤λ¥Ό μ°Ύμ•„μ•Ό ν•λ‹¤.
4. μ„λΉ„μ¤ μ‚¬μ© : ν΄λΌμ΄μ–ΈνΈλ” Eurekaλ΅λ¶€ν„° λ°›μ€ μ„λΉ„μ¤ μΈμ¤ν„΄μ¤ λ©λ΅ μ¤‘ ν•λ‚λ¥Ό μ„ νƒν•μ—¬ μ”μ²­μ„ λ³΄λ‚Έλ‹¤. μ΄λ•, ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“ λ΅λ“ λ°Έλ°μ‹±μ„ ν†µν•΄ λ¶€ν•κ°€ κ³ λ¥΄κ² λ¶„μ‚°λλ‹¤.
5. μ„λΉ„μ¤ μƒνƒ κ°μ‹ : Eureka μ„λ²„λ” μ£ΌκΈ°μ μΌλ΅ λ“±λ΅λ μ„λΉ„μ¤μ μƒνƒλ¥Ό ν™•μΈν•λ‹¤. λ§μ•½ μ„λΉ„μ¤κ°€ μ‘λ‹µν•μ§€ μ•λ”λ‹¤λ©΄ ν•΄λ‹Ή μΈμ¤ν„΄μ¤λ¥Ό λ‹¤λ¥Έ μΈμ¤ν„΄μ¤λ΅ λ€μ²΄ν•  μ μλ‹¤.
6. λ™μ  μ„λΉ„μ¤ λ³€κ²½ : μƒλ΅μ΄ μ„λΉ„μ¤ μΈμ¤ν„΄μ¤κ°€ μ¶”κ°€λκ±°λ‚ κΈ°μ΅΄ μΈμ¤ν„΄μ¤κ°€ μ κ±°λλ©΄, Eurekaλ” μ΄λ¥Ό κ°μ§€ν•κ³  μ„λΉ„μ¤ λ©λ΅μ„ μ—…λ°μ΄νΈν•λ‹¤.


### Eureka μ„λ²„ μ„¤μ • :

```
server : 
	port : 8761
eureka: 
	client:
		register-with-eureka: false
		fetch-registry: false

```

μ„ μ„¤μ •μ€ Eureka μ„λ²„λ¥Ό 8761 ν¬νΈλ΅ μ‹¤ν–‰ν•λ©°, μ„λΉ„μ¤ λ“±λ΅ λ° μ„λΉ„μ¤ λ©λ΅ μ΅°νλ¥Ό μ„ν• μ„¤μ •μ΄λ‹¤.

`register-with-eureka`, `fetch-registry` λ¥Ό falseλ΅ μ„¤μ •ν•μ—¬ ν•΄λ‹Ή μ„λ²„λ” μμ‹ μ„ λ“±λ΅ν•μ§€ μ•κ³ , λ“±λ΅λ μ„λΉ„μ¤ λ©λ΅μ„ κ°€μ Έμ¤μ§€ μ•λ„λ΅ μ„¤μ •ν–λ‹¤.


### μ”μ•½ :

Spring cloud Eurekaλ” μ„λΉ„μ¤ λ””μ¤μ»¤λ²„λ¦¬λ¥Ό μ‰½κ² κµ¬ν„ν•  μ μλ„λ΅ ν•΄μ£Όλ” λΌμ΄λΈλ¬λ¦¬μ΄λ‹¤. μ„λΉ„μ¤ λ“±λ΅, κ°μ§€, μƒνƒ λ¨λ‹ν„°λ§ λ“±μ„ ν†µν•΄ λ§μ΄ν¬λ΅μ„λΉ„μ¤ κ°„μ ν¨μ¨μ μΈ ν†µμ‹ μ„ κ°€λ¥ν•λ„λ΅ ν•΄μ¤€λ‹¤.


### μ‹¤μµν•κΈ°

ν”„λ΅μ νΈ μƒμ„± μ‹ λ””μ¤μ»¤λ²„λ¦¬ μ λ μΉ΄ μ„λ²„λ¥Ό μ¶”κ°€ν•΄μ¤€λ‹¤.

![μ λ μΉ΄ μ‹¤μµ1]()

![μ λ μΉ΄ μ‹¤μµ2](https://file+.vscode-resource.vscode-cdn.net/c%3A/PlayData/phase02/class/)

![μ λ μΉ΄ μ‹¤μµ3](https://file+.vscode-resource.vscode-cdn.net/c%3A/PlayData/phase02/class/)


### Eureka μ„λ²„μ— μ„λΉ„μ¤ λ“±λ΅ν•κ³  ν™•μΈν•κΈ°

μ λ μΉ΄ μ„λ²„μ— λ“±λ΅ν•  μ„λΉ„μ¤λ” Eureka Discovery Client μμ΅΄μ„±μ„ μ¶”κ°€ν•΄μ¤μ•Ό ν•λ‹¤.

![μ λ μΉ΄ ν΄λΌμ΄μ–ΈνΈ μ‹¤μµ1]()


μƒμ„±λ ν”„λ΅μ νΈ ServiceApplication ν΄λμ¤μ— @EnableDiscoveryClient μ–΄λ…Έν…μ΄μ…μ„ μ¶”κ°€ν•΄μ¤€λ‹¤.

![μ λ μΉ΄ ν΄λΌμ΄μ–ΈνΈ μ‹¤μµ2]()

μ„ μ–΄λ…Έν…μ΄μ…μ΄ μ¶”κ°€λΌμ•Ό μ λ μΉ΄ μ„λ²„μ—μ„ ν΄λΌμ΄μ–ΈνΈλ΅ μΈμ‹λλ©° ν†µμ‹ μ΄ κ°€λ¥ν•΄μ§„λ‹¤.


application.yml νμΌμ— λ§μ΄ν¬λ΅μ„λΉ„μ¤ ν¬νΈλ²νΈμ™€ λ§μ΄ν¬λ΅μ„λΉ„μ¤ λ…μΉ­μ„ μ¶”κ°€ν•΄μ¤€λ‹¤.

![μ λ μΉ΄ ν΄λΌμ΄μ–ΈνΈ μ‹¤μµ3](https://file+.vscode-resource.vscode-cdn.net/c%3A/PlayData/phase02/class/)


ν΄λΌμ΄μ–ΈνΈλ¥Ό μ λ μΉ΄ μ„λ²„μ— λ“±λ΅ν•΄μ¤€λ‹¤.

![μ λ μΉ΄ μ„λ²„ ν΄λΌμ΄μ–ΈνΈ μ¶”κ°€]()

- λ“±λ΅ μ „ μ λ μΉ΄ λ€μ‹λ³΄λ“

![μ λ μΉ΄ λ€μ‹λ³΄λ“1](https://file+.vscode-resource.vscode-cdn.net/c%3A/PlayData/phase02/class/)

- λ“±λ΅ ν›„ μ λ μΉ΄ λ€μ‹λ³΄λ“

![μ λ μΉ΄ λ€μ‹λ³΄λ“2](https://file+.vscode-resource.vscode-cdn.net/c%3A/PlayData/phase02/class/)


### λ™μΌ ν”„λ΅μ νΈλ΅ μ„λ²„ 2κ° μ΄μƒ μ‹¤ν–‰μ‹ν‚¤κΈ°

μ‹¤μ  λΉλ“ νμΌμ„ 2κ° μ΄μƒ μ‹¤ν–‰μ‹μΌλ„ λμ§€λ§, ν•λ‚μ μΈν…”λ¦¬μ μ΄μ—μ„ μ—¬λ¬ κ°μ μ„λΉ„μ¤ μΈμ¤ν„΄μ¤λ¥Ό μ‹¤ν–‰ ν•΄λ³΄μ.

![μ„λΉ„μ¤ μ¶”κ°€1]()

λ¨Όμ € μ„μ²λΌ Edit ConfigurationμΌλ΅ μ΄λ™ν•λ‹¤.

![μ„λΉ„μ¤ μ¶”κ°€2](https://file+.vscode-resource.vscode-cdn.net/c%3A/PlayData/phase02/class/)

μ„μ²λΌ μ™Όμ½μ—μ„ 3λ²μ§Έ λ³µμ‚¬ λ²„νΌμ„ λλ¬μ¤€ λ’¤ apply λ²„νΌμ„ ν†µν•΄ μ μ©ν•΄μ¤€λ‹¤.

λ³µμ‚¬ ν›„ μ‹¤ν–‰ νƒ­μ„ λ‹¤μ‹ λ³΄λ©΄ μ΄μ  2κ°μ μ„ νƒμ§€κ°€ μλ”κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

μ„μ λ³µμ‚¬λ μΈμ¤ν„΄μ¤λ¥Ό μ¶”κ°€λ΅ μ‹¤ν–‰ μ‹ν‚¤λ©΄,


μ„μ²λΌ ν¬νΈ μ¶©λλ΅ μΈν•΄ μ‹¤ν–‰μ΄ λμ§€ μ•λ”λ‹¤.

μ΄λ” λ³Έλ μΈμ¤ν„΄μ¤μ—μ„ 8003λ² ν¬νΈλ¥Ό μ‚¬μ© μ¤‘μ΄κΈ° λ•λ¬Έμ΄λ‹¤.

μ΄λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄μ„λ”

1. μ„λ²„ μ‹¤ν–‰ λ‹¨κ³„μ—μ„ ν¬νΈκ°’μ„ μƒλ΅­κ² μ§€μ •ν•λ‹¤.
2. κ° μ„λ²„ μ‹¤ν–‰ μ‹λ§λ‹¤ λλ¤ν¬νΈλ¥Ό μ‹¤ν–‰ν•λ„λ΅ ν•λ‹¤.

λΌλ” ν•΄κ²°μ±…μ΄ μλ‹¤.


μ°μ„ , 1λ² λ¶€ν„° ν™•μΈν•΄λ³΄λ©΄

- application.yml νμΌμ—μ„ port λ²νΈ μμ •.
- Edit Configuration - add VM Options μ—μ„ μ¶”κ°€.

`-Dserver.port=ν¬νΈλ²νΈ`

μ„μ—μ„ -Dλ” detach λ¨λ“λ¥Ό μλ―Έν•λ©°, μ½μ†”μ°½μ„ μ¨κΈ°κ³  μ• ν”λ¦¬μΌ€μ΄μ…μ„ κ°€λ™ν•λ‹¤λ” μλ―Έμ΄λ‹¤.

μ΄λ” μΈν…”λ¦¬μ μ΄ μ½μ†”μ°½μ΄ ν•λ‚μ΄κΈ° λ•λ¬Έμ—, λ‘ κ° μ΄μƒμ„ ν•λ‚μ μΈν…”λ¦¬μ μ΄μ—μ„ κΈ°λ™ μ‹ μ½μ†”μ°½μ„ μ¨κ²¨μ¤μ•Ό ν•λ‹¤.

κ° μΈμ¤ν„΄μ¤λ§λ‹¤ ν¬νΈλ²νΈλ¥Ό λ°”κΎΈλ” κ²ƒμ€ μλ―Έκ°€ μ—†λ‹¤.(μΈμ¤ν„΄μ¤ κ°―μκ°€ μ»¤μ§μλ΅ μ΄λ¥Ό μλ™μΌλ΅ λ³„λ„ μ§€μ •ν•λ” κ²ƒμ€ μ¤λ¥κ°€ λ‚  ν™•λ¥ μ΄ λ†’μ•„μ§„λ‹¤.)


κ²°κµ­, 2λ² λ°©λ²•μΌλ΅ ν¬νΈλ¥Ό μ¶”κ°€ν•΄μ¤€λ‹¤.
