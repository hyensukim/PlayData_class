# 3. SOLID 원칙

의존성 관리를 통해 유연하고 재사용이 간능한 코드로 작성하기 위한 원칙.

## 🎇 객체 지향 기본 4원칙

- 캡슐화
  - 필드를 은닉하여 간접적으로 메서드를 통해서만 노출되도록 함.
- 상속
  - 메서드 상속은 리스코프 치환 원칙을 위반할 가능성이 높기 때문에 사용을 지양한다.
  - 다른 클래스의 메서드 사용 시 컴포지트 패턴을 대신 사용한다.
- 추상화
  - 객체의 공통적인 특징만 뽑아내어 인터페이스로 묶어 추상화 계층을 추가하는 것.
- 다형성
  - 같은 메서드 호출 코드로 클라이언트에게 다른 서비스 결과를 제공할 수 있도록 해주는 것.(다형성 + 재정의)

## 🎇 SRP, 단일 책임 원칙

하나의 클래스는 하나의 책임만을 가져야 한다.

하나의 클래스에는 유지 보수 시에 변경해야 하는 사항이 하나여야 한다.

![r](https://raw.githubusercontent.com/hyensukim/PlayData_class/main/images/SRP.png)

컨트롤러 : 통신 방식은 여러가지 이기 때문에, http로 요청(통신)을 하지 않는 경우 수정.

서비스 : 기능이 변경되는 경우 수정.

레포지토리 : 다른 저장소를 쓰는 경우(저장소 변경 이슈) 수정.

서비스에서 http 코드를 설정하는 경우 http 대신 다른방식으로 통신하게 될 때 controller와 service 2곳을 수정해야 한다.(단일 책임 원칙에 위배)

각 레포지토리가 변경되면 서비스까지 같이 변경해야하는 문제가 발생한다.(응집력 저하)

따라서 3계층 layer로 코드를 분할 시 각 계층별로 나눠둔 것이다.

당연히 반드시 필요한 부분을 호출하는 것은 위배되더라도 사용이 가능하다.

## 🎇 OCP, 개방 폐쇄 원칙

확장에는 열려있어야 하고 변경에는 닫혀 있어야 한다.

일례로, 인터페이스를 사용하면 중간에 다른 종류의 레포지토리를 추가해도 문제가 없다.

즉, 서비스 레이어에 Repository(Interface) 타입으로 변수를 선언한 경우 이를 구현한 모든 레포지토리는 어떠한 레포지토리도 대입이 가능하기 때문에, 확장에 열리게 된다.

또한 구현체를 삭제해도 다른 구현체에 영향을 미치지 않는다.

## 🎇 LSP, 리스코프 치환 원칙

부모 클래스에서 실행 가능한 코드는 자식 클래스에서도 사용이 가능해야 한다.(교체)

부모 코드보다 자식 클래스에서 코드의 범위가 절대 줄어들면 안된다.

즉, 자식 클래스에서는 코드의 범위가 부모 클래스의 메서드를 포함하며, 이에 추가적인 기능의 코드를 추가하여 확장해야 한다.

사용하는 이유는 SOLID 원칙의 대전제는 클라이언트 측 코드를 수정하지 않고 확장이 가능하도록 짜는 것이다.

만약, 리스코프 치환의 원칙을 위배할 경우, 클라이언트 측 코드도 수정해야 하는 상황이 발생하기 때문이다.

또한, 이는 자바에서 부모를 상속한 자식 클래스에서 필드의 접근제한자의 범위를 축소하는 것을 금지하는 것도 LSP에 따라 그런 것이다.

## 🎇 ISP, 인터페이스 분리 원칙

클라이언트 별로 세분화된 인터페이스를 만들어야 한다.

단일책임원칙과 비슷해 보이지만 관점이 다르다.

ISP 관점에서 인터페이스 내 관련이 없는 추상 메서드를 하나로 정의해놓았을 때, 이를 구현한 클래스는 사용하지도 않는 메서드를 구현해야 하는 문제가 발생한다.

구현 이후에도 서비스측에서 사용 시, 관련 없는 구현 메서드도 함께 노출된다.

따라서 인터페이스는 용도별로 분류되어야 한다는 것이 ISP의 핵심 내용이다.

## 🎇 DIP, 의존 역전 원칙

고수준 컴포넌트 : 서비스 레이어, ...

저수준 컴포넌트 : 레포지토리 레이어, ...

고수준 컴포넌트는 저수준 컴포넌트에 의존하지 않아야 한다.

즉, 전통적인 의존 관계를 반전(역전) 시킴으로써 상위 계층이 하위 계층의 구현으로부터 독립되도록 할 수 있다.

**고수준의 추상 레이어**를 중간에 끼워 넣어서 의존 방향을 바꿔야 한다. 즉, 고수준 과 저수준이 모두 추상 계층(인터페이스)에 의존해야 한다.

개방폐쇄원칙과 의존역전원칙은 관점만 다르지 해결 방법은 비슷하다.

- 간접적으로 의존 역전 원칙이 깨지는 상황
  - 고수준에서 저수준 계층에서 발생한 예외를 처리하는 경우 해당 예외명을 통해 저수준 계층에 어떤 구조로 이뤄져있는지 노출됨.
  - 이를 해결하기 위해서 범용 예외를 만들어서 던져주기도 한다.
