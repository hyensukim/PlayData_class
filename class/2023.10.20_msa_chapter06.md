# μ©μ–΄ μ •λ¦¬

β… λ¶„μ‚° μ‹μ¤ν… :

* μΈν„°λ„· μƒμ— λ¶„μ‚°λ μ—¬λ¬ μ»΄ν“¨ν„°λ΅ μ‘μ—…μ„ μ²λ¦¬ν•κ³ , κ·Έ κ²°κ³Όλ¥Ό μƒνΈ κµν™ν•λ„λ΅ κµ¬μ„±ν• μ‹μ¤ν….

β… νμΌ κ²½λ΅ : file:// μμ•½μ–΄λ¥Ό ν†µν•΄ νμΌ&λ””λ ‰ν† λ¦¬ κ²½λ΅μ—μ„ κ²€μƒ‰ν•¨μ„ 

β… μ•”νΈν™” κ΄€λ ¨ - [λ€μΉ­ &amp; λΉ„λ€μΉ­ ν‚¤](https://github.com/hyensukim/PlayData_class/blob/main/class/%EC%96%B8%EC%96%B4%20%EC%84%A4%EB%AA%85/%EB%8C%80%EC%B9%AD%ED%82%A4%20%EB%B9%84%EB%8C%80%EC%B9%AD%ED%82%A4.md)

λ€μΉ­ν‚¤ : μ•”νΈν™” -λ³µνΈν™”κ°€ λ™μΌν• ν‚¤λ΅ κ°€λ¥ν• ν‚¤ Ex) μ‹μ € μ•”νΈ

λΉ„λ€μΉ­ν‚¤ : μ•”νΈν™” - λ³µνΈν™”κ°€ λ‹¤λ¥Έ ν‚¤λ΅ κ°€λ¥ν• ν‚¤ Ex) κ³µκ°ν‚¤ - λΉ„κ³µκ°ν‚¤

π•¶οΈ μ°Έκ³  : mysql μ—°λ™ μ„¤μ • μ‹,

driver-class-name : com.mysql.cj.jdbc.Driver # 8λ²„μ „ μ΄μƒ

diver-class-name : com.mysql.jdbc.Driver # κµ¬λ²„μ „


# 6.Config μ„λ²„λ¥Ό ν™μ©ν• μ—°λ™

## π† Spring Cloud Config

Spring Cloud Configλ” λ¶„μ‚° μ‹μ¤ν…μ„ μ„ν• μ™Έλ¶€ κµ¬μ„± κ΄€λ¦¬λ¥Ό μ κ³µν•λ‹¤. μ΄λ¥Ό ν†µν•΄ μ• ν”λ¦¬μΌ€μ΄μ…μ μ„¤μ •μ„ μ¤‘μ•™ μ§‘μ¤‘μ‹μΌλ΅ κ΄€λ¦¬ν•κ³ , μ„λΉ„μ¤ κ°„μ— μ„¤μ •μ„ κ³µμ ν•  μ μλ‹¤.


### π‡ Spring Cloud Config μ„λ²„μ μ£Όμ” νΉμ§•κ³Ό μ‘λ™ λ°©μ‹:

1. **μ¤‘μ•™ μ§‘μ¤‘ν™”λ μ„¤μ • μ €μ¥μ†** :

* Spring Cloud Config μ„λ²„λ” ***μ• ν”λ¦¬μΌ€μ΄μ…μ μ„¤μ • νμΌμ„ μ €μ¥ν•κ³  κ΄€λ¦¬***ν•λ” μ¤‘μ•™ μ§‘μ¤‘ν™”λ μ €μ¥μ†μ΄λ‹¤.
* μ΄ μ €μ¥μ†λ” Git, SVN λ“±μ λ²„μ „ κ΄€λ¦¬ μ‹μ¤ν…μ„ μ‚¬μ©ν•  μ μλ‹¤.

2. **μ™Έλ¶€ κµ¬μ„± μ†μ¤ μ§€μ›** :

* Spring Cloud Configλ” λ‹¤μ–‘ν• μ™Έλ¶€ κµ¬μ„± μ†μ¤λ¥Ό μ§€μ›ν•λ‹¤. μ£Όλ΅ Gitμ΄ μ‚¬μ©λμ§€λ§, λ‹¤λ¥Έ μ†μ¤λ„ μ‚¬μ© κ°€λ¥ν•λ‹¤.

3. **λ‹¤μ–‘ν• ν™κ²½μ— λ€ν• μ„¤μ • μ κ³µ** :

* Spring Cloud Configλ” κ°κ°μ ν™κ²½(κ°λ°, ν…μ¤νΈ, μ΄μ λ“±)μ— λ€ν• μ„¤μ •μ„ κµ¬μ„±ν•  μ μλ‹¤.
* κ° μ• ν”λ¦¬μΌ€μ΄μ…μ€ μμ‹ μ ν™κ²½μ— λ§κ² κµ¬μ„±λ μ„¤μ •μ„ κ°€μ Έμ¬ μ μλ‹¤.

4. **μ„λΉ„μ¤ κ°„μ μ„¤μ • κ³µμ ** :

* λ‹¤μμ μ„λΉ„μ¤κ°€ μμ„ λ•, κ° μ„λΉ„μ¤λ” Spring Cloud Config μ„λ²„μ—μ„ μ„¤μ •μ„ κ°€μ Έμ™€ μ‚¬μ©ν•  μ μλ‹¤.
* μ΄λ¥Ό ν†µν•΄ μ„λΉ„μ¤ κ°„μ— μΌκ΄€λ κµ¬μ„±μ„ μ μ§€ν•  μ μλ‹¤.

5. **λ™μ μΌλ΅ μ„¤μ • λ³€κ²½ κ°μ§€** :

* Spring Cloud Config ν΄λΌμ΄μ–ΈνΈλ” μ •κΈ°μ μΌλ΅ Config μ„λ²„μ— μ„¤μ •μ„ μ”μ²­ν•λ©°, λ³€κ²½ μ‚¬ν•­μ΄ μμ„ κ²½μ° λ‹¤μ‹ λ΅λ“ν•λ‹¤.
* μ΄λ¥Ό ν†µν•΄ λ™μ μΌλ΅ μ„¤μ •μ„ μ—…λ°μ΄νΈν•  μ μλ‹¤.

6. **λ³΄μ• λ° μ•”νΈν™”** :

* Spring Cloud Configλ” λ³΄μ• κΈ°λ¥μ„ μ κ³µν•μ—¬ μ„¤μ •μ„ μ•μ „ν•κ² κ΄€λ¦¬ν•λ‹¤.
* λ―Όκ°ν• μ •λ³΄λ¥Ό ν¬ν•¨ν•λ” μ„¤μ •μ€ μ•”νΈν™”ν•  μ μλ‹¤.

7. **ν”„λ΅ν•„ μ§€μ›** :

* Spring Profilesλ¥Ό μ‚¬μ©ν•μ—¬ κ° ν™κ²½ λ° μƒν™©μ— λ”°λΌ λ‹¤λ¥Έ μ„¤μ •μ„ μ κ³µν•  μ μλ‹¤.


### π‡ Spring Cloud Config μ„λ²„λ¥Ό μ„¤μ •ν•λ” κ³Όμ •:

#### Spring Cloud Config μ„λ²„ μ„¤μ •

0. λ””λ ‰ν† λ¦¬ λ° yml νμΌ μƒμ„± :

- νμΌμ„ μƒμ„± ν• λ’¤ κΈ°μ΅΄μ— application.ymlμ— μ €μ¥ν•λ μ„¤μ • μ •λ³΄λ¥Ό λ‹΄λ”λ‹¤.

1. **ν”„λ΅μ νΈ μƒμ„±** :

- spring-cloud-config-server μμ΅΄μ„ μ¶”κ°€ν• ν”„λ΅μ νΈλ¥Ό μƒμ„±ν•΄μ¤€λ‹¤.

  ![μ‚¬μ§„1](https://github.com/hyensukim/PlayData_class/blob/main/images/9%EC%9D%BC%EC%B0%A8/config%20%EC%84%9C%EB%B2%84%20%EC%84%A4%EC%A0%95%201.png?raw=true)

2. **μ„λ²„ ν™μ„±ν™” μ–΄λ…Έν…μ΄μ… μ¶”κ°€** :

- Application ν΄λμ¤ μ„μ— @EnableConfigServer μ–΄λ…Έν…μ΄μ…μ„ μ¶”κ°€ν•΄μ¤€λ‹¤.

3. **Config μ„λ²„ ν¬νΈ μ¶”κ°€ :**

- μ„λ²„ application.yml νμΌ λ‚΄ μ„λ²„ ν¬νΈ `8888` λ΅ λ“±λ΅ν•λ‹¤.

4. **μ €μ¥λ μ„¤μ • μ •λ³΄ κ²½λ΅ λ“±λ΅** :

- μ„λ²„ application.yml νμΌ λ‚΄ μ„¤μ • μ •λ³΄κ°€ λ‹΄κΈ΄ yml νμΌμ λ΅μ»¬ μ λ€ κ²½λ΅λ¥Ό μ…λ ¥ν•λ‹¤.
- `file : //` : νμΌ(& λ””λ ‰ν† λ¦¬) μ‹μ¤ν…μ—μ„ ν•΄λ‹Ή κ²½λ΅λ¥Ό μ°ΎμΌλΌκ³  μ§€μ •.
- μ„ κ²½λ΅λ” terminal μƒμ— pwdλ¥Ό κ²€μƒ‰ν•μ—¬ λ‚μ¨ κ²½λ΅λ¥Ό λ³µλ¶™ν•λ©΄ λλ‹¤.

```
spring:
  cloud:
    config:
      server:
        git:
          uri: file://λ΅μ»¬μ— μ €μ¥λ μ λ€ κ²½λ΅
```

5. μ„¤μ • μ •λ³΄ λ“±λ΅ μ—¬λ¶€ ν™•μΈ

- μ›ΉλΈλΌμ°μ €μ— `127.0.0.1:ν¬νΈλ²νΈ/yml νμΌλ…/default` μΌλ΅ μ…λ ¥ν•λ©΄ ν•΄λ‹Ή yml νμΌμ΄ μ΅°νλλ‹¤λ©΄ μ—°λ™ μ„±κ³µ.
- μ„¤μ • νμΌλ§λ‹¤ ν”„λ΅ν•„ λ“±λ΅μ΄ κ°€λ¥ν•λ©°, λ°©λ²•μ€ `νμΌλ…-ν”„λ΅ν•„λ….yml` λ΅ μ…λ ¥ν•΄μ£Όλ©΄ λλ‹¤.
- μ΅°ν λ°©λ²•μ€ `127.0.0.1:ν¬νΈλ²νΈ/yml νμΌλ…/ν”„λ΅ν•„λ…` μΌλ΅ μ…λ ¥ν•λ©΄ μ΅°ν κ°€λ¥ν•λ‹¤.

> [Spring Cloud Config κ³µμ‹ λ¬Έμ„](Spring Cloud Config - https://docs.spring.io/spring-cloud-config/docs/current/reference/html/)

#### Spring Cloud Config ν΄λΌμ΄μ–ΈνΈ μ„¤μ •

0. **μμ΅΄ μ¶”κ°€** :

* `spring-cloud-starter-config` λ° `spring-cloud-starter-bootstrap` μμ΅΄ μ¶”κ°€.

1. **μ‚¬μ©ν•  Config μ„λ²„ μ„¤μ •** :

* **`bootstrap.yml`** λλ” **`bootstrap.properties`** νμΌμ„ μ‚¬μ©ν•μ—¬ Config μ„λ²„λ¥Ό μ„¤μ •ν•λ‹¤. μ΄ νμΌμ€ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ μ‹μ‘λ  λ• κ°€μ¥ λ¨Όμ € μ½νλ‹¤.

```
spring:
  cloud:
    config:
      uri: spring-cloud-config μ„λ²„ ν¬νΈ
      name: μ„¤μ • μ •λ³΄κ°€ λ‹΄κΈ΄ yml νμΌλ…(ex, db.yml -> db)
```

2. **μ™Έλ¶€ κµ¬μ„± μ†μ¤ μ—°κ²°** :

* Config μ„λ²„κ°€ μ‚¬μ©ν•  μ™Έλ¶€ κµ¬μ„± μ†μ¤(Git, SVN λ“±)λ¥Ό μ„¤μ •.
* Gitμ κ²½μ°, `git init` μ„ ν†µν•΄ μƒμ„± ν›„ commit κΉμ§€ ν•΄μ£Όλ©΄ λλ‹¤.

3. **Config ν΄λΌμ΄μ–ΈνΈ μ„¤μ •** :

* κ° μ„λΉ„μ¤μ—μ„ Config ν΄λΌμ΄μ–ΈνΈλ¥Ό μ„¤μ •ν•κ³ , μ–΄λ–¤ μ• ν”λ¦¬μΌ€μ΄μ…μ μ–΄λ–¤ μ„¤μ •μ„ κ°€μ Έμ¬μ§€ μ •μν•λ‹¤.

4. **μ• ν”λ¦¬μΌ€μ΄μ… μ½”λ“μ—μ„ μ„¤μ • μ‚¬μ©** :

* Config μ„λ²„μ—μ„ κ°€μ Έμ¨ μ„¤μ •μ€ μ• ν”λ¦¬μΌ€μ΄μ… μ½”λ“μ—μ„ **`@Value`** μ–΄λ…Έν…μ΄μ… λλ” **`Environment`** κ°μ²΄λ¥Ό ν†µν•΄ μ‚¬μ©ν•  μ μλ‹¤.

Spring Cloud Configλ” λ¶„μ‚° μ‹μ¤ν…μ—μ„ μ„¤μ • κ΄€λ¦¬λ¥Ό ν¨μ¨μ μΌλ΅ μ²λ¦¬ν•κ³ , λ³€κ²½ μ‚¬ν•­μ„ λ™μ μΌλ΅ μ μ©ν•  μ μλ„λ΅ λ„μ™€μ¤€λ‹¤.

λ΅μ»¬μ— μ €μ¥ν•λ” λ°©μ‹μ€ κ°€μƒ PC μƒμ„± ν›„ μ΄ μ„λ²„λ¥Ό config μ„λ²„λ΅ μ„¤μ •ν•μ—¬ λ°°ν¬ν•λ©΄ λλ‹¤.

ν•μ§€λ§, μ΄λ¬ν• κ²½μ° λ³€λ™ μ‚¬ν•­μ΄ λ°μƒν•μ€μ„ κ²½μ° κ°€μƒ PCμ— μ ‘μ†ν•μ—¬ μ½”λ“λ¥Ό μμ •ν•΄μ•Ό ν•λ‹¤.

μ›κ²© λ ν¬λ¥Ό μ΄μ©ν• μ²λ¦¬λ¥Ό μ‚¬μ©ν•λ©΄ μ΄λ¬ν• λ¬Έμ μ μ„ ν•΄κ²°ν•  μ μλ‹¤.


## π† μ›κ²© λ ν¬μ§€ν† λ¦¬μ— μ¬λ¦° νμΌμ„ μ΄μ©ν• μ²λ¦¬

### Public Repo

1. μ›κ²© λ ν¬μ§€ν† λ¦¬ μƒμ„±
2. yml νμΌ push
3. μ„λ²„ λ‚΄ application.yml νμΌμ„ μ•„λμ™€ κ°™μ΄ μ‘μ„±

```
spring:
  cloud:
    config:
      server:
        git:
          uri: λ ν¬μ§€ν† λ¦¬ μ£Όμ†
```


### Private Repo

application.yml νμΌμ„ μ•„λμ™€ κ°™μ΄ μ‘μ„±

```
spring:
  cloud:
    config:
      server:
        git:
          uri: λ ν¬μ§€ν† λ¦¬ μ£Όμ†
          username: κΉƒν—λΈ κ³„μ •λ… # νΌλΈ”λ¦­μ—μ„λ” λ¶ν•„μ”
          password: κΉƒν—λΈ ν¨μ¤μ›λ“ # νΌλΈ”λ¦­μ—μ„λ” λ¶ν•„μ”
```

μ΄ ν›„ usernameκ³Ό passwordλ” μ•”νΈν™” ν•΄μ¤€λ‹¤.

μ•”νΈν™”μ— ν•„μ”ν• ν‚¤λ” VM optionμ„ ν†µν•΄μ„

μ „λ‹¬ν•΄μ£Όλ©΄, λΉλ“ μ‹ ν•΄λ‹Ή ν‚¤λ΅ κ²€μ¦μ΄ μ΄λ¤„μ§€κ² λμ–΄ λ³΄μ•μ΄ μ¬λΌκ°„λ‹¤.
